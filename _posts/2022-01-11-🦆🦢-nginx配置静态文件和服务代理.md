---
  layout: post
  tilte: "2022-01-11-ğŸ¦†ğŸ¦¢-nginxé…ç½®é™æ€æ–‡ä»¶å’ŒæœåŠ¡ä»£ç†.md"
  date: 2022-01-11-
  tags: 
    - å¼€å‘æ—¥å¸¸

---


* content
{:toc}


éœ€è¦æŠŠå‰åç«¯åˆ†ç¦»çš„é¡¹ç›®éƒ¨ç½²åˆ°æœåŠ¡å™¨,
å‰ç«¯é™æ€èµ„æºé€šè¿‡nginxä»£ç†è®¿é—®,æ¥å£è¯·æ±‚ä»£ç†åˆ°æŒ‡å®šç«¯å£çš„æœåŠ¡ä¸Š,å…ˆçœ‹é…ç½®:

```
server {
    listen       4040;
    server_name  127.0.0.1;
    
    location / {
       root   /opt/demo/static;
       index  index.html index.htm;
    }
    
    location /api {
      proxy_pass   http://example.com:4041/;
    }
}
```
nginxä»£ç†ç«¯å£4040, åå°æœåŠ¡ç«¯å£4041. è¿™ä¸ªè¦æ³¨æ„äº†,nginxç›‘å¬çš„ç«¯å£ä¸èƒ½ä¸æœåŠ¡ç«¯å£ç›¸åŒ
1.`/æ ¹ç›®å½•` --è¢«ä»£ç†åˆ°--> `/opt/demo/static`è·¯å¾„ä¸‹
é‚£ä¹ˆåœ¨staticä¸‹çš„é™æ€èµ„æºå°±å¯ä»¥ç›´æ¥è¢«è®¿é—®äº†,å½¢å¼:Â [http://127.0.0.1:4040/index.html](http://127.0.0.1:4040/index.html)


2.ä»¥`api`å¼€å¤´çš„è¯·æ±‚--è¢«ä»£ç†åˆ°-->`4041`ç«¯å£
æ¯”å¦‚ï¼š
`http://127.0.0.1:4040/api/test`
è¢«ä»£ç†åˆ°--> `http://example.com:4041/api/test`

packè„šæ‰‹æ¶nginxé¡¹ç›®é…ç½®ï¼Œç”Ÿäº§ç¯å¢ƒ
```
resolver 10.138.92.77;
location ^~ / {
  set $entry index.html;
  set $prefix http://cdn.haier.net/assets/overlay/dts-fe/html-entries-prod;
  set $project_name <é¡¹ç›®å>;
  proxy_pass $prefix/$project_name/$entry;
}

```
çº¿ä¸Šå®Œæ•´ç‰ˆé…ç½®
```
user  nginx;
worker_processes  1;
error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;
events {
    worker_connections  1024;
}
http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;
    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';
    access_log  /var/log/nginx/access.log  main;
    sendfile        on;
    #tcp_nopush     on;
    keepalive_timeout  65;
    #gzip  on;
    include /etc/nginx/conf.d/*.conf;
    server {
        listen       80 default_server;
        listen       [::]:80 default_server;
        server_name  _;
        client_max_body_size 20M;
        include /etc/nginx/default.d/*.conf;

        resolver 10.138.92.77;
        location ^~ / {
          set $entry index.html;
          set $prefix http://cdn.haier.net/assets/overlay/dts-fe/html-entries-prod;
          # ä¸‹é¢ä¸€è¡Œå¡«å†™GitLabé¡¹ç›®åœ°å€
          set $project_name myproject;
          proxy_pass $prefix/$project_name/$entry;
        }
    }
}
```
> [1] https://www.cnblogs.com/linyufeng/p/13361640.html
[2] https://www.jianshu.com/p/b010c9302cd0
