---
  layout: post
  tilte: "ğŸ±ğŸ±-æœ€è¿‘ä½¿ç”¨è®¾è®¡æ¨¡å¼æ€»ç»“.md"
  date: 2021-01-11-
  tags: 
    - ç¼–ç¨‹èŒƒå¼

---


* content
{:toc}


![](https://upload-images.jianshu.io/upload_images/15312191-65e75b099f3724f7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

#### 1.è®¢é˜…å‘å¸ƒæ¨¡å¼

ä¼—æ‰€å‘¨çŸ¥ï¼Œreactä¸­æ²¡æœ‰busè¿™ä¸ªæ¦‚å¿µï¼Œå¦‚æœé‡åˆ°reactä¸­ä½¿ç”¨busçš„æƒ…å†µï¼Œæ€ä¹ˆåŠå‘¢
é¦–å…ˆ , ä»€ä¹ˆæ˜¯bus, event Bus is only a Global Function Register;
```js

let Bus = function () {
  this.cache = [];
};
// register
Bus.prototype.$on = function (handleEvent, fn) {
  for (let i = 0; i < this.cache.length; i++) {
    let [first] = Object.keys(this.cache[i]);
    if (first === handleEvent) {
      return;
    }
  }
  this.cache.push({
    [handleEvent]: fn
  });
};
// trigger
Bus.prototype.$emit = function (handleEvent) {
  const [first, ...rest] = Array.from(arguments);
  for (let i = 0; i < this.cache.length; i++) {
    if (this.cache[i][handleEvent]) {
      this.cache[i][handleEvent](...rest);
    }
  }
};
// cancel register
Bus.prototype.$off = function (handleEvent) {
  for (let i = 0; i < this.cache.length; i++) {
    let [first] = Object.keys(this.cache[i]);
    if (first === handleEvent) {
      this.cache.splice(i, 1);
      i = i - 1;
    }
  }
};

```
##### Exampleï¼š
```js

let bus = new Bus();
bus.$on("send",()=>{
  console.log("onSend")
})
bus.$emit("send") // onSend

```
## 

#### 2.è£…é¥°å™¨æ¨¡å¼
js æœ¬èº«æ²¡æœ‰è£…é¥°å™¨ @è¯­æ³•ç³–ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©babelæ’ä»¶
```js

npm i @babel/plugin-proposal-decorators @babel/plugin-proposal-class-properties -S

```
ç„¶åé…ç½® babal-loader
```
 {
    test: /\.(tsx?|jsx)$/,
    exclude: /node_modules/,
    use: {
      loader: "babel-loader",
      options: {
        sourceMaps: true,
        presets: [
          ["@babel/preset-typescript", { isTSX: true, allExtensions: true}]
        ],
        plugins: [
          [
            "@babel/plugin-proposal-decorators",
            {
              "legacy": true
            }
          ],
          [
            "@babel/plugin-proposal-class-properties",
            {
              "loose": true
            }
          ]
        ]
      }
    }
  };
```
coolï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨è£…é¥°è€…äº†ï¼Œ
##### Example:
åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ç¢°åˆ°ï¼Œè¿ç»­ç‚¹å‡»å¯¼è‡´é—®é¢˜çš„æƒ…å†µ,æ­¤æ—¶æˆ‘ä»¬å¯ä»¥é‡‡ç”¨debounceï¼ˆé˜²æŠ–ï¼‰å’Œthrottleï¼ˆèŠ‚æµï¼‰çš„æ–¹å¼æ¥å‡å°‘è°ƒç”¨é¢‘ç‡ï¼ŒåŒæ—¶åˆä¸å½±å“å®é™…æ•ˆæœ.
å·² debounceä¸ºä¾‹ï¼š
App.jsx
```js

import debounce from "./debounce"
class App extends React.Component {
  constructor(props) {
    super(props);
  }
  @debounce(500, false)
  handleOk() {
     this.post('xxx')
  }

  render() {
    return (
      <div className="App">
        <button onClick={handleOk.bind(this)}
        </button>
      </div>
    );
  }
}

```
debounce.js
```js

function _debounce(func, wait) {
  let timeout;
  return function () {
    if (timeout) {
      clearTimeout(timeout);
      timeout = null;
    } else {
      timeout = setTimeout(() => {
        func.apply(this);
      }, wait);
    }
  };
}

const debounce = wait => {
  return function handleDescriptor(target, key, descriptor) {
    const callback = descriptor.value;
    if (typeof callback !== "function") {
      throw new SyntaxError("Only functions can be debounced");
    }
    const fn = _debounce(callback, wait);
    return {
      ...descriptor,
      value() {
        fn.apply(this);
      }
    };
  };
};
export default debounce;

```
#### 3.ä»£ç†æ¨¡å¼
ä»£ç†æ¨¡å¼ç¬¦åˆè®¾è®¡æ¨¡å¼ä¸­å•ä¸€åŸåˆ™ï¼Œæ˜¯éå¸¸å¸¸è§çš„è®¾è®¡æ¨¡å¼ï¼Œreact HOCæœ¬èº«å°±æ˜¯ä»£ç†æ¨¡å¼çš„å˜ç§
##### Easy Example:
```js

        /**************** è®¡ç®—ä¹˜ç§¯ *****************/
        var mult = function(){
            var a = 1;
            for ( var i = 0, l = arguments.length; i < l; i++ ){
              a = a * arguments[i];
            }
            return a;
        };

        /**************** è®¡ç®—åŠ å’Œ *****************/
        var plus = function(){
            var a = 0;
            for ( var i = 0, l = arguments.length; i < l; i++ ){
              a = a + arguments[i];
            }
            return a;
        };

        /**************** åˆ›å»ºç¼“å­˜ä»£ç†çš„å·¥å‚ *****************/
        var createProxyFactory = function( fn ){
            var cache = {};
            return function(){
              var args = Array.prototype.join.call( arguments, ', ' );
              if ( args in cache ){
                  return cache[ args ];
              }
              return  cache[ args ] = fn.apply( this, arguments );
            }
        };

        var proxyMult = createProxyFactory( mult ),
        proxyPlus = createProxyFactory( plus );

        alert ( proxyMult( 1, 2, 3, 4 ) );    // è¾“å‡ºï¼š24
        alert ( proxyMult( 1, 2, 3, 4 ) );    // è¾“å‡ºï¼š24
        alert ( proxyPlus( 1, 2, 3, 4 ) );    // è¾“å‡ºï¼š10
        alert ( proxyPlus( 1, 2, 3, 4 ) );    // è¾“å‡ºï¼š10

```
#####  React HOC Example:

åœ¨ä¸€ä¸ªè½¯ä»¶ä¸­ï¼Œæœ‰è®¸å¤šè¡¨æ ¼ç±»ï¼Œç½‘é¡µï¼Œæ¯ä¸ªç½‘é¡µéƒ½æœ‰æœç´¢æ ï¼Œè¡¨æ ¼é¡µç ï¼Œè”åŠ¨ï¼Œå¦‚æœæ¯ä¸ªé¡µé¢æˆ‘ä»¬éƒ½è¦ç»„åˆè¿™äº›ç»„ä»¶ï¼Œå†™æœç´¢é€»è¾‘ï¼Œit's waste;



#### 4.å•ä¾‹æ¨¡å¼
new Vue mark
