---
  layout: post
  tilte: "😄😁-读取后端验证码图片的几种方法.md"
  date: 2021-10-21-
  tags: 
    - 开发日常

---

![](https://upload-images.jianshu.io/upload_images/15312191-93378d34692cfaa5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

#### responseType: blob
 -  this.kaptcha = window.URL.createObjectURL(blob);
 - fileReader.readAsDataURL 转base64
 ```
 const blobToBase64 = (blob)  => {
      return new Promise((resolve, reject) => {
        const fileReader = new FileReader();
        fileReader.onload = e => {
          resolve(e.target.result);
        };
        fileReader.readAsDataURL(blob);
        fileReader.onerror = () => {
          reject(new Error("文件流异常"));
        };
      });
 }
verificationCode().then(async blob => {
  this.kaptcha = blobToBase64(blob)
}

 ```
- blob 转 arraybuffer 转 base64
```
verificationCode().then(async blob => {
  ransformArrayBufferToBase64(response);
}

const async transformArrayBufferToBase64 = (response) => {
      response = await this.fileReadAsArrayBuffer(response);
      this.kaptcha =
        "data:image/png;base64," +
        btoa(
          new Uint8Array(response).reduce(
            (data, byte) => data + String.fromCharCode(byte),
            ""
          )
        );
 }
```
####  responseType: arraybuffer
-  arraybuffer 转 base64
```
verificationCode().then(blob => {
    this.kaptcha = "data:image/png;base64," +
          btoa(
            new Uint8Array(response).reduce(
              (data, byte) => data + String.fromCharCode(byte),
              ""
            )
          );
}

```

#### 额外知识点
arraybuffer转Blob

 ```
var buffer = new ArrayBuffer(16);
var blob = new Blob([buffer]);
```
blob转arraybuffer
借助FileReader对象
```
var blob = new Blob([1,2,3,4,5]);
var reader = new FileReader();

reader.onload = function() {
    console.log(this.result);
}
reader.readAsArrayBuffer(blob);
```
