---
  layout: post
  tilte: "ğŸ¥·-JS-ä¸‹è½½æ–‡ä»¶ä¸¤ç§æ–¹å¼æ€»ç»“.md"
  date: 2022-3-16-
  tags: 
    - å¼€å‘æ—¥å¸¸

---


* content
{:toc}


  ####  1.åå°æœåŠ¡å™¨æœ‰é™æ€èµ„æºä¸”æ˜¯å›ºå®šçš„æ–‡ä»¶åï¼ˆGETæ–¹å¼ä¸‹è½½æ–‡ä»¶ï¼‰

åœºæ™¯ï¼šå·²ç»ç”Ÿæˆçš„é™æ€æ–‡ä»¶
##### ä½¿ç”¨js
```
window.location.href="http://www.åŸŸå/template.xlsx(æ–‡ä»¶å)"
```
##### html
```
<a href="http://www.åŸŸå/template.xlsx(æ–‡ä»¶å)"></a>
```
`ps`: æœ‰è·¨åŸŸé—®é¢˜
#### 2.åå°è¿”å›æ–‡ä»¶æµ
åœºæ™¯ï¼šåŠ¨æ€æ•°æ®ç”Ÿæˆ
##### ä½¿ç”¨ FileReader
```
axios.post(è¯·æ±‚è·¯å¾„URL, {å‚æ•°Params}, {
            responseType: 'blob'
          }).then(function(res){
            var blob = res.data;
           // FileReaderä¸»è¦ç”¨äºå°†æ–‡ä»¶å†…å®¹è¯»å…¥å†…å­˜
            var reader = new FileReader();
            reader.readAsDataURL(blob);
            // onloadå½“è¯»å–æ“ä½œæˆåŠŸå®Œæˆæ—¶è°ƒç”¨
            reader.onload = function(e) {
              var a = document.createElement('a');
              // è·å–æ–‡ä»¶åfileName
              var fileName = res.headers["content-disposition"].split("=");
              fileName = fileName[fileName.length - 1];
              fileName = fileName.replace(/"/g, "");
              a.download = fileName;
              a.href = e.target.result;
              document.body.appendChild(a);
              a.click();
              document.body.removeChild(a);
            }
          });
```
##### ä½¿ç”¨window.URL.createObjectURL
```
axios.post(è¯·æ±‚è·¯å¾„URL, {å‚æ•°Params}, {
            responseType: 'blob'
          }).then(function(response){
            const name = "XXX.xls"
             const url = window.URL.createObjectURL(new Blob([response]));
             const link = document.createElement("a");
             link.href = url;
             link.download = name
             document.body.appendChild(link);
             link.click();
             document.body.removeChild(link);
          });
```
åŠ¨æ€æ•°æ®ä¸‹è½½ï¼ŒåŸç†éƒ½æ˜¯åˆ›å»º blobåè®®çš„é“¾æ¥
